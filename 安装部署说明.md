# 安装部署说明

## 🎯 重要配置提醒

⚠️ **关键点**: 使用 Next.js 静态导出模式，构建输出目录必须设置为 `out`

## 📋 系统要求

- Node.js 20.17.0 或更高版本
- npm 或 yarn 包管理器
- Git (用于克隆仓库)

## 🚀 快速开始

### 1. 克隆项目
```bash
git clone https://github.com/hughes53/ip.git
cd ip
```

### 2. 安装依赖
```bash
npm install
```

### 3. 本地开发
```bash
npm run dev
```
访问 http://localhost:3000

### 4. 构建生产版本
```bash
npm run build
```
⚠️ **重要**: 构建输出在 `out/` 目录，不是 `.next/` 目录

## 🌐 部署选项

### Cloudflare Pages (推荐)

**配置要求**:
```
Framework preset: Next.js (Static HTML Export)
Build command: npm run build
Build output directory: out  ← 必须是 "out"
Node.js version: 20.17.0
Root directory: (留空)
```

详细步骤: [Cloudflare部署教程.md](./Cloudflare部署教程.md)

### Vercel 部署

```bash
npm install -g vercel
vercel --prod
```

### Netlify 部署

**配置**:
```
Build command: npm run build
Publish directory: out
Node.js version: 20.17.0
```

### 静态文件服务器

构建完成后，`out/` 目录包含所有静态文件，可以部署到任何静态托管服务:

```bash
npm run build
# 将 out/ 目录上传到你的静态托管服务
```

## 🔧 配置说明

### next.config.ts 关键配置

```typescript
const nextConfig: NextConfig = {
  output: 'export',           // 静态导出模式
  trailingSlash: false,
  distDir: 'out',            // 输出目录
  assetPrefix: '',
  images: {
    unoptimized: true        // 静态部署必需
  },
  eslint: {
    ignoreDuringBuilds: true, // 避免构建时问题
  },
  webpack: (config, { dev }) => {
    if (!dev) {
      config.cache = false;   // 生产环境禁用缓存
    }
    return config;
  },
};
```

### package.json 脚本

```json
{
  "scripts": {
    "dev": "next dev -p 3000",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## 🛠️ 技术栈

- **框架**: Next.js 15.3.0
- **语言**: TypeScript
- **UI 库**: Radix UI
- **样式**: Tailwind CSS
- **状态管理**: React Hooks + Signals
- **HTTP 客户端**: Axios

## 📁 项目结构

```
├── app/                    # Next.js App Router
│   ├── components/         # React 组件
│   ├── services/          # API 服务
│   └── types/             # TypeScript 类型
├── hooks/                 # 自定义 Hooks
├── services/              # 业务逻辑服务
├── signals/               # 状态管理
├── public/                # 静态资源
├── out/                   # 构建输出目录 (重要)
└── scripts/               # 工具脚本
```

## 🔍 故障排除

### 问题1: 部署后显示 404
**原因**: 构建输出目录配置错误
**解决**: 确保部署平台的输出目录设置为 `out`

### 问题2: 构建失败
**原因**: Node.js 版本不兼容
**解决**: 使用 Node.js 20.17.0 或更高版本

### 问题3: 样式不加载
**原因**: 静态资源路径问题
**解决**: 检查 `next.config.ts` 中的 `assetPrefix` 配置

### 问题4: 邮箱功能不工作
**原因**: 使用了本地邮箱生成服务
**解决**: 这是正常的，邮箱是本地生成的，无需外部 API

## 📊 性能优化

- ✅ 静态导出，无服务器依赖
- ✅ 本地邮箱生成，无 API 调用
- ✅ 优化的构建配置
- ✅ 禁用不必要的缓存

## 🎉 功能特性

- 🌍 基于 IP 的真实地址生成
- 📧 本地邮箱生成服务
- 👤 随机用户信息生成
- 📱 响应式设计
- 🎨 深色/浅色主题
- 📝 历史记录功能

---

**部署成功示例**: https://ip-8hq.pages.dev/

如有问题，请确保按照上述配置要求进行设置，特别注意构建输出目录必须为 `out`。
